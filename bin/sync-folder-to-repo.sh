#!/usr/bin/env bash

repo_path="${1%/}"

folder_path="${2:-pub/}"

rsync --delete --exclude .git --exclude .github --exclude .gitignore "$repo_path/" "${folder_path%/}/"
pushd "$repo_path"

upstream_rev_shortsha="$(cat klipper/.version)"
commit_message="Autogenerated - Upstream $upstream_rev_shortsha"

git add .
git commit -m "$commit_message"

popd
